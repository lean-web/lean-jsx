"use strict";(self.webpackChunklean_jsx_docs=self.webpackChunklean_jsx_docs||[]).push([[8349],{876:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>g});var r=n(2784);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(n),f=i,g=d["".concat(s,".").concat(f)]||d[f]||u[f]||a;return n?r.createElement(g,o(o({ref:t},c),{},{components:n})):r.createElement(g,o({ref:t},c))}));function g(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=f;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:i,o[1]=l;for(var p=2;p<a;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},6242:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var r=n(7896),i=(n(2784),n(876));const a={sidebar_position:2},o="Project structure",l={unversionedId:"tutorial-basics/project-structure",id:"tutorial-basics/project-structure",title:"Project structure",description:"A LeanJSX project generated with generator-lean-jsx has the following structure:",source:"@site/docs/tutorial-basics/project-structure.md",sourceDirName:"tutorial-basics",slug:"/tutorial-basics/project-structure",permalink:"/lean-jsx/docs/tutorial-basics/project-structure",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Setting up LeanJSX",permalink:"/lean-jsx/docs/tutorial-basics/create-a-project"},next:{title:"Create a new page",permalink:"/lean-jsx/docs/tutorial-basics/create-a-new-page"}},s={},p=[{value:".build",id:"build",level:3},{value:"Bundling configuration",id:"bundling-configuration",level:4},{value:"src/index.html",id:"srcindexhtml",level:3},{value:"src/express.tsx",id:"srcexpresstsx",level:3},{value:"src/engine.ts",id:"srcenginets",level:3},{value:"context.ts",id:"contextts",level:3},{value:"sxl.d.ts",id:"sxldts",level:3}],c={toc:p},d="wrapper";function u(e){let{components:t,...n}=e;return(0,i.kt)(d,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"project-structure"},"Project structure"),(0,i.kt)("p",null,"A LeanJSX project generated with ",(0,i.kt)("inlineCode",{parentName:"p"},"generator-lean-jsx")," has the following structure:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},".\n\u251c\u2500\u2500 .build\n|   \u251c\u2500\u2500 build.cjs\n|   \u251c\u2500\u2500 watch.cjs\n\u251c\u2500\u2500 build.cjs\n\u251c\u2500\u2500 package-lock.json\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 src\n\u2502   \u251c\u2500\u2500 components\n\u2502   \u2502   \u251c\u2500\u2500 app.tsx\n\u2502   \u2502   \u2514\u2500\u2500 slow.tsx\n\u2502   \u251c\u2500\u2500 context.ts\n\u2502   \u251c\u2500\u2500 engine.ts\n\u2502   \u251c\u2500\u2500 express.tsx\n\u2502   \u251c\u2500\u2500 index.html\n\u2502   \u2514\u2500\u2500 web\n\u2502       \u251c\u2500\u2500 app.css\n\u2502       \u251c\u2500\u2500 app.js\n\u2502       \u2514\u2500\u2500 public\n\u251c\u2500\u2500 sxl.d.ts\n\u2514\u2500\u2500 tsconfig.json\n")),(0,i.kt)("h3",{id:"build"},".build"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},".build")," directory contains scripts for bundling the web application (",(0,i.kt)("inlineCode",{parentName:"p"},".build/build.cjs"),") and to run the bundled server, watching for file changes ",(0,i.kt)("inlineCode",{parentName:"p"},".build/watch.cjs"),". Both of these files depend on the root file ",(0,i.kt)("inlineCode",{parentName:"p"},"build.cjs"),", which contains the full bundling configuration."),(0,i.kt)("p",null,"All scripts use the CommonJS extension ",(0,i.kt)("inlineCode",{parentName:"p"},"cjs"),", as the ",(0,i.kt)("inlineCode",{parentName:"p"},"product.json")," is configured with ",(0,i.kt)("inlineCode",{parentName:"p"},'type: "module"'),"."),(0,i.kt)("h4",{id:"bundling-configuration"},"Bundling configuration"),(0,i.kt)("p",null,"The configuration has two main sections: ",(0,i.kt)("inlineCode",{parentName:"p"},"web")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"server"),". The ",(0,i.kt)("inlineCode",{parentName:"p"},"web")," section provides ",(0,i.kt)("a",{parentName:"p",href:"https://vitejs.dev/config/"},"Vite's configuration")," for bundling ",(0,i.kt)("inlineCode",{parentName:"p"},"index.html"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"server")," the ",(0,i.kt)("a",{parentName:"p",href:"https://esbuild.github.io/api/"},"esbuild configuration")," for transpiling and bundling ",(0,i.kt)("inlineCode",{parentName:"p"},"express.tsx"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'const conf = {\n// The Vite configuration for the web part:\nweb: {\n    root,\n    publicDir: resolve(root, "./web/public"),\n    build: {\n        outDir,\n        assetsDir: "assets",\n        emptyOutDir: true\n    },\n    plugins: [injectScript("lean-jsx")]\n},\n// The configuration for the server part:\nserver: {\n    // The path to the bundled server script:\n    main: resolve(\n        outDir,\n        basename(main).replace(\n            /\\.(js|tsx?)/,\n            bundledOutExtensionMap[extname(main)]\n        )\n    ),\n    // The esbuild building configuration:\n    esbuildOptions: {\n        entryPoints: [main],\n        platform: "node",\n        bundle: true,\n        outdir: resolve(__dirname, "./dist"),\n        format: "cjs",\n        external: [...Object.keys(packageConfig.dependencies)],\n        outExtension,\n        loader: {\n            ".png": "dataurl",\n            ".svg": "text"\n        }\n    }\n}\n')),(0,i.kt)("h3",{id:"srcindexhtml"},"src/index.html"),(0,i.kt)("p",null,"This is the main template skeleton. It defines a placeholder (",(0,i.kt)("inlineCode",{parentName:"p"},"\x3c!--EAGER_CONTENT--\x3e"),", by default) where JSX-defined content will be render."),(0,i.kt)("p",null,"This template is processed and bundled by Vite, and any scripts and CSS resources follow ",(0,i.kt)("a",{parentName:"p",href:"https://vitejs.dev/guide/build.html"},"Vite's bundling process"),"."),(0,i.kt)("h3",{id:"srcexpresstsx"},"src/express.tsx"),(0,i.kt)("p",null,"The main entry point for the application. This file contains the definition of the Express server, along with all sample route handlers."),(0,i.kt)("p",null,"The file also includes an example of how to use LeanJSX's Express middleware for supporting ",(0,i.kt)("a",{parentName:"p",href:"/docs/architecture/static-vs-dynamic#getdynamiccomponent"},"JavaScript loaded content"),"."),(0,i.kt)("h3",{id:"srcenginets"},"src/engine.ts"),(0,i.kt)("p",null,"This scripts creates the instance of LeanJSX engine that will be used by ",(0,i.kt)("inlineCode",{parentName:"p"},"express.tsx"),". It contains default startup configurations:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'import { buildApp } from "lean-jsx/lib/server";\nimport path from "path";\n\nconst INDEX_HTML_PATH = path.resolve(__dirname, "index.html");\n\nconst app = buildApp({\n    templates: {\n        index: {\n            path: INDEX_HTML_PATH,\n            contentPlaceholder: "\x3c!--EAGER_CONTENT--\x3e"\n        }\n    },\n    logging: {\n        defaultLogLevel: "info"\n    }\n});\n\nexport default app;\n')),(0,i.kt)("p",null,"The ",(0,i.kt)("strong",{parentName:"p"},"templates")," section defines the list of all template skeletons that are available in the project, along with the configuration for the placeholder that will be replaced with JSX-defined content. More than one template can be configured; by default it creates a single template named ",(0,i.kt)("inlineCode",{parentName:"p"},"index"),". This key is then referenced when rendering content in ",(0,i.kt)("inlineCode",{parentName:"p"},"express.tsx"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-tsx"},'await LeanEngine.renderWithTemplate(\n    res,\n    <App />,\n    globalContext,\n    {\n        // as defined in `engine.ts`\n        templateName: "index"\n    }\n);\n')),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"logging")," section defines the configuration for the logging used. Out of the box, LeanJSX can be configured to store logs in independent files for each logging level. For instance, the following configuration stores errors in a text file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"logging: {\n    defaultLogLevel: \"info\",\n    file: {\n        error: {\n            destination: 'path/to/error/logfile.log'\n        }\n    }\n}\n")),(0,i.kt)("p",null,"Developers can get an instance of the logger directly from ",(0,i.kt)("inlineCode",{parentName:"p"},"LeanEngine"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'const logger = LeanEngine.logger({\n    defaultLogLevel: "info"\n});\n')),(0,i.kt)("h3",{id:"contextts"},"context.ts"),(0,i.kt)("p",null,"This file overrides the ",(0,i.kt)("a",{parentName:"p",href:"/docs/architecture/state-and-context#global-context"},"global context")," namespace ",(0,i.kt)("inlineCode",{parentName:"p"},"lean-jsx/src/types/context")," to allow developers to extend it and add their own type definitions to it."),(0,i.kt)("p",null,"It also provides a default function to parse query parameters and inject them into the global context. For more details on the global context, visit ",(0,i.kt)("a",{parentName:"p",href:"/docs/architecture/state-and-context#global-context"},"its documentation page"),"."),(0,i.kt)("h3",{id:"sxldts"},"sxl.d.ts"),(0,i.kt)("p",null,"LeanJSX relies on the TypeScript global namespace ",(0,i.kt)("inlineCode",{parentName:"p"},"SXL")," for type validation in JSX elements. The type definition ",(0,i.kt)("inlineCode",{parentName:"p"},"sxl.d.ts")," imports this namespace, along with the types for intrinsic HTML elements."))}u.isMDXComponent=!0}}]);