"use strict";(self.webpackChunklean_jsx_docs=self.webpackChunklean_jsx_docs||[]).push([[2652],{876:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(2784);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),u=r,h=d["".concat(l,".").concat(u)]||d[u]||m[u]||o;return n?a.createElement(h,i(i({ref:t},p),{},{components:n})):a.createElement(h,i({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8388:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var a=n(7896),r=(n(2784),n(876));const o={sidebar_position:4},i="Static and dynamic content",s={unversionedId:"architecture/static-vs-dynamic",id:"architecture/static-vs-dynamic",title:"Static and dynamic content",description:"Work in progress. Support for updating dynamic content after the page is loaded is currently on process, which means that dynamic behavior post page load needs to be manually implemented by developers.",source:"@site/docs/architecture/static-vs-dynamic.md",sourceDirName:"architecture",slug:"/architecture/static-vs-dynamic",permalink:"/lean-jsx/docs/architecture/static-vs-dynamic",draft:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"HTTP streaming",permalink:"/lean-jsx/docs/architecture/streaming"},next:{title:"Event handlers, state, and context management",permalink:"/lean-jsx/docs/architecture/state-and-context"}},l={},c=[{value:"Dynamic content use cases",id:"dynamic-content-use-cases",level:2},{value:"GetDynamicComponent",id:"getdynamiccomponent",level:3}],p={toc:c},d="wrapper";function m(e){let{components:t,...o}=e;return(0,r.kt)(d,(0,a.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"static-and-dynamic-content"},"Static and dynamic content"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("em",{parentName:"p"},"Work in progress. Support for updating dynamic content after the page is loaded is currently on process, which means that dynamic behavior post page load needs to be manually implemented by developers.")),(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("em",{parentName:"p"},"While LeanJSX doesn't require frameworks like React or Vue for base rendering, it doesn't prohibit their use: Developers can still use these tools to define fully-dynamic content.")),(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("em",{parentName:"p"},"The advantage of using these frameworks on top of LeanJSX is that developers can implement dynamic behavior only where it's needed, instead of making the whole application dynamic by default.")),(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("em",{parentName:"p"},"All frameworks support managing only small parts of the application, but some like ",(0,r.kt)("a",{parentName:"em",href:"https://developer.mozilla.org/en-US/docs/Learn/Tools_and_testing/Client-side_JavaScript_frameworks/Svelte_getting_started"},"Svelte")," are particularly good for these use cases."))),(0,r.kt)("p",null,"Most content in web applications can be categorized in two:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Static content"),": Content that will not change during the lifetime of a single page load. Some characteristics of static content are:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Content is only rendered once. To update it, users need to refresh the page or navigate back and forth."),(0,r.kt)("li",{parentName:"ul"},"It ",(0,r.kt)("em",{parentName:"li"},"can")," be interactive (e.g. navigation or menu items), but the interactivity performed is within the scope of traditional HTML pages: content that changes state using CSS (e.g. hover) and default HTML behavior (navigation using links)."),(0,r.kt)("li",{parentName:"ul"},"Examples of this content can be articles, blog posts, navigation menus, and so on."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Dynamic content"),": Content that changes during the lifetime of a single page load, commonly as the result of an action performed by a user or by content pushed by the server (e.g. web sockets).")),(0,r.kt)("p",null,"Traditional server-oriented web frameworks by default treat all content as static content. On the other side, JavaScript frameworks like React treat all content as dynamic content."),(0,r.kt)("p",null,"Modern JavaScript frameworks perform a lot of internal optimizations to avoid re-rendering static content, but developers can easily make mistakes that cause static content to be re-rendered when not needed."),(0,r.kt)("p",null,"LeanJSX assumes that all content is static, unless it is explicitely configured to be dynamic by default."),(0,r.kt)("h2",{id:"dynamic-content-use-cases"},"Dynamic content use cases"),(0,r.kt)("p",null,"The most common use case for dynamic content is to update page content ",(0,r.kt)("em",{parentName:"p"},"after")," the page finishes loading. By defering heavy or slow data computation to asynchronous network calls, SPAs optimize for initial rendering."),(0,r.kt)("p",null,"With its support of defered asynchronous, static content loading, LeanJSX avoids relying on JavaScript to update content after page load. However, LeanJSX offers one utility to support JavaScript-based lazy loading of content: ",(0,r.kt)("inlineCode",{parentName:"p"},"GetDynamicComponent"),"."),(0,r.kt)("h3",{id:"getdynamiccomponent"},"GetDynamicComponent"),(0,r.kt)("p",null,"Even when asynchronous components avoid blocking rendering by emitting placeholders, events like ",(0,r.kt)("inlineCode",{parentName:"p"},"DOMContentLoaded")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"load")," will not be triggered until the whole page loads. If developers rely on these events to render dynamic content (e.g. render JavaScript-frameworks-based components or native web components), blocking them could lead to poor user experience."),(0,r.kt)("p",null,"When the page needs to be marked as rendered but slow-loading static content needs to be supported, developers can create JavaScript-rendered static content with ",(0,r.kt)("inlineCode",{parentName:"p"},"GetDynamicComponent"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'export const JSComponent = GetDynamicComponent(\n    "dynamic-slow",\n    async () => {\n        await wait(100);\n        return "Slow resource";\n    },\n    resource => {\n        if (resource.isPending) {\n            return <p id="loading2">Loading...</p>;\n        }\n        return <p id="loaded2">{resource.value}</p>;\n    }\n);\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"GetDynamicComponent")," generates two distinct server-side handlers: A non-blocking, stream-based component that can be used directly in other JSX components:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"function App() {\n    return (\n        <main>\n            <h1>Title</h1>\n            <JSComponent.Render />\n        </main>\n    );\n}\n")),(0,r.kt)("p",null,"And one blocking, API-oriented handler for the server to expose as an endpoint. This handler is automatically stored by ",(0,r.kt)("inlineCode",{parentName:"p"},"GetDynamicComponent")," in an internal registry of dynamic components."),(0,r.kt)("p",null,"These two handlers in conjunction, perform the following actions:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The content returned when ",(0,r.kt)("inlineCode",{parentName:"li"},"resource.isPending")," is ",(0,r.kt)("inlineCode",{parentName:"li"},"true")," is streamed directly to the response when ",(0,r.kt)("inlineCode",{parentName:"li"},"<JSComponent.Render />")," is evaluated as a ",(0,r.kt)("strong",{parentName:"li"},"placeholder"),"."),(0,r.kt)("li",{parentName:"ul"},"The rest of the contents are streamed to the response, without waiting for ",(0,r.kt)("inlineCode",{parentName:"li"},"JSComponent"),"'s full response."),(0,r.kt)("li",{parentName:"ul"},"In parallel, ",(0,r.kt)("inlineCode",{parentName:"li"},"JSComponent")," is rendered inside a ",(0,r.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_components"},"LeanJSX-managed")," web component that performs the following steps using JavaScript:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"The server evaluates ",(0,r.kt)("inlineCode",{parentName:"li"},"JSComponent")," ",(0,r.kt)("strong",{parentName:"li"},"synchronously")," (which means that ",(0,r.kt)("inlineCode",{parentName:"li"},"resource.isPending")," will be ",(0,r.kt)("inlineCode",{parentName:"li"},"false"),") and returns pure HTML."),(0,r.kt)("li",{parentName:"ul"},"Request the actual contents of ",(0,r.kt)("inlineCode",{parentName:"li"},"JSComponent")," by making a network request to the server."),(0,r.kt)("li",{parentName:"ul"},"Once the request completes, it replaces the placeholder with the response from the API request.")))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Activity diagram showing how JavaScript-based content is fetched after page finishes loading",src:n(8457).Z,width:"1110",height:"948"})),(0,r.kt)("p",null,"How is this different from just using React or any other framework directly?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Unlike common JS framework flows, the async API request returns ",(0,r.kt)("strong",{parentName:"li"},"HTML"),", instead of data content like JSON. Then, the whole placeholder is replaced. This approach allows us to avoid having to track internal state for ",(0,r.kt)("inlineCode",{parentName:"li"},"JSComponent")," and building the content on the browser. The DOM update can be done efficiently."),(0,r.kt)("li",{parentName:"ul"},"The API endpoint setup is done by LeanJSX's middleware. Developers can just pass the instance of ",(0,r.kt)("inlineCode",{parentName:"li"},"JSComponent")," and all the wiring between the client-side component and the API is done automatically."),(0,r.kt)("li",{parentName:"ul"},"Not state-tracking for each component. LeanJSX deals with pure HTML, which means that no virtual DOM or similar constructs are needed. this improves rendering performance, but requires specific patterns to retain ",(0,r.kt)("a",{parentName:"li",href:"/docs/architecture/state-and-context"},"application state and context"),".")),(0,r.kt)("p",null,"With these approaches to render content, LeanJSX allows high-performance, asynchronous rendering without having to rely on memory and network intensive, browser-side rendering."))}m.isMDXComponent=!0},8457:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/js-content-diagram-92aae8cf9189a3dbff75641dbeddb001.png"}}]);